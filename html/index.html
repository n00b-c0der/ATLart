<!DOCTYPE html>
<html>
  <title>ATLart</title>

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.firebase.com/libs/geofire/4.1.2/geofire.min.js"></script>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css"/>

    <style>
      body {
        font-family: "Raleway", Arial, sans-serif;
      }

      .w3-row img {
        margin-bottom: -8px;
      }
    </style>
    <style>
      /* Set the size of the div element that contains the map */
      #map {
        height: 400px; /* The height is 400 pixels */
        width: 100%; /* The width is the width of the web page */
      }
    </style>
  </head>

  <body>
    <div class="w3-content" style="max-width:1500px">
      <header class="w3-container w3-xlarge w3-padding-24">
        <a href="#" class="w3-left w3-button w3-white">MY ART</a>
        <a href="#about" class="w3-right w3-button w3-white">About</a>
      </header>

      <div class="w3-row">
        <div class="w3-half">
          <img src="../assets/images/streetart.jpg" style="width:100%" />
          <img src="../assets/images/streetart2.jpg" style="width:100%" />

        </div>

        <div class="w3-half">
          <img src="../assets/images/streetart3.jpg" style="width:100%" />
          <img src="../assets/images/streetart4.jpg" style="width:100%" />
        </div>
      </div>
    </div>

    <footer class="w3-light-grey w3-padding-64 w3-center" id="about">
      <h2>About</h2>
      <img
        src="../assets/images/about.jpg"
        class="w3-image w3-padding-32"
        width="300"
        height="300"
      />
      <form
        style="margin:auto;width:60%"
        action="/action_page.php"
        target="_blank"
      >
        <p>
          Just me, myself and I, exploring the universe of unknownment. I have a
          heart of love and an interest of lorem ipsum and mauris neque quam
          blog. I want to share my world with you. Praesent tincidunt sed tellus
          ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
          congue gravida diam non fringilla. Praesent tincidunt sed tellus ut
          rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
          congue gravida diam non fringilla.
        </p>
        <p class="w3-large w3-text-pink">Do not hesitate to contact me!</p>
        <div class="w3-section">
          <label><b>Name</b></label>
          <input class="w3-input w3-border" type="text" required name="Name" />
        </div>
        <div class="w3-section">
          <label><b>Email</b></label>
          <input class="w3-input w3-border" type="text" required name="Email" />
        </div>
        <div class="w3-section">
          <label><b>Message</b></label>
          <input class="w3-input w3-border" required name="Message" />
        </div>
        <button type="submit" class="w3-button w3-block w3-dark-grey">
          Send
        </button>
      </form>
    </footer>
    
    <h1>Hello, world!</h1>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <div class="container">

        <!-- Jumbotron -->
        <div class="jumbotron">
            <h1 class="text-center">Employee Tracker</h1>
        </div>

        <div class="row">

            <!-- Sign-Up Card-->
            <div class="col-lg-6">
                <div class="card card-default">
                    <div class="card-header">
                        New Member Sign-Up
                    </div>
                    <div class="card-body">
                        <!-- Sign-up Form (note the various input "types")-->
                        <form role="form" onSubmit="FunctionSubmit(event)">
                            <div class="form-group row">
                                <label for="name-input">User Name:</label>
                                <input class="form-control" id="userName" type="text" required>
                            </div>
                            <div class="form-group row">
                                <label for="email-input">Image title:</label>
                                <input class="form-control" id="imageTitle" type="text" required>
                            </div>
                            <div class="form-group row">
                                <label for="age-input">upload Date:</label>
                                <input class="form-control" id="uploadDate" type="date" required>
                            </div>
                            <div class="form-group row">
                                <label for="age-input">Address:</label>
                                <input class="form-control" id="Address" type="text" required>
                            </div>
                            <div class="form-group row">
                                <label for="age-input">Description:</label>
                                <input class="form-control" id="Description" type="text" required>
                            </div>
                            <div class="card">
                                <label class="file-upload-container" for="file-upload">
                                    <input id="file-upload" type="file"> Blah
                                </label>
                            </div>
                            <div>
                                <img src="" class="displayImages">
                            </div>
                            <button class="btn btn-default" id="submit-button" type="submit">Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <h3>My Google Maps Demo</h3>
    <!--The div element for the map -->
    <div id="map"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.map"></script> -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      // this is all from cloudinary  the url to where we will save our images
      var CLOUDNARY_URL = "https://api.cloudinary.com/v1_1/ronwab/upload";
      //upload preset in cloudinary https://cloudinary.com/console/settings/upload  scroll to upload presets
      var CLOUDNARY_UPLOAD_PRESET = "ffghjylr";
      //imgPreview is an image i had on the screen
      var imgPreview = document.getElementById("img-preview");
      //this creates the thingi to upload the images https://www.w3schools.com/tags/att_input_type_file.asp
      // I am not sure why they use "for" in the  body tag
      var fileUpload = document.getElementById("file-upload");

      //Adding an event listener called change.. I think we could also have used click..
      //This syntax i believe is vanila JS. we can always tweak it to jquery if we need to
      fileUpload.addEventListener("change", function(event) {
        event.preventDefault();

        //saving the response back from clicking the button
        var file = event.target.files[0];
        //FormData() is built in JS to help create key value pairs that can be used to send data
        // https://developer.mozilla.org/en-US/docs/Web/API/FormData
        var formData = new FormData();
        formData.append("file", file);
        formData.append("upload_preset", CLOUDNARY_UPLOAD_PRESET);

        //similar to ajax Tried using ajax but was getting an error that I did not understand :-(
        // $.ajax({
        axios({
          // see line 25
          url: CLOUDNARY_URL,
          // POST request pushes img to where ever we are saving
          method: "POST",
          //not sure about this guy
          headers: {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          //not sure about this guy
          data: formData

          //This is just a callback function
        }).then(function(res) {
          console.log(res);
          // setting returned results to the imgPreview
          imgPreview.src = res.data.secure_url;
        });
      });
    </script>

    <script src="https://www.gstatic.com/firebasejs/5.9.4/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.map"></script> -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCQUPXI0N7-b4bOpNlb6n8ML1p6YW5VJ48",
        authDomain: "ronwab-8dbcd.firebaseapp.com",
        databaseURL: "https://ronwab-8dbcd.firebaseio.com",
        projectId: "ronwab-8dbcd",
        storageBucket: "ronwab-8dbcd.appspot.com",
        messagingSenderId: "148535054528"
      };
      firebase.initializeApp(config);

      var selectedFile;
      var locationCoodsvals = "/";

      var myLatLng;

      $("#file-upload").on("change", function(e) {
        e.preventDefault();

        selectedFile = e.target.files[0];

        uploadFile();
      });

      function uploadFile() {
        var filename = selectedFile.name;
        console.log(filename);

        // Create a root reference
        var storageRef = firebase.storage().ref("/TestImages/" + filename);

        var uploadTask = storageRef.put(selectedFile);
      }
      var filename = "img1.jpg";
      var imgRef = firebase.storage().ref("/TestImages/" + filename);

      $("#downloadbutton").on("click", function(e) {
        imgRef.getDownloadURL().then(function(url) {
          console.log(url);
          console.log(e);

          var imageOnPage = $("displayImages");
          imageOnPage.append(url);
          console.log("here");
          console.log(imageOnPage);
        });
      });
    </script>

    <script>
      
      function initMap() {
        var map = new google.maps.Map(document.getElementById("map"), {
          zoom: 11,
          center: { lat: Number(33.7490), lng: Number(-84.3880) }
        });

        var myLatLng = firebase.database().ref("/");

        myLatLng.on("value", function(snapChot) {
          // TODO:
          // Firebase values coming here
          var data = snapChot.val(); // { rahdnkey: { locationCoodsvals: {} }, anyotherrahdnkey: { locationCoodsvals: {} } }

          for (var key in data) {
            let userLocation = data[key].locationCoodsvals;
            console.log(userLocation);
            var marker = new google.maps.Marker({
              position: userLocation,
              map: map,
              title: "Hello World!"
            });
          }
        });
      }
    </script>
    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDq2hOQHj-qstNYUsl7a8kHOtrkeJVhdro&callback=initMap"
    ></script>
  </body>
</html>
