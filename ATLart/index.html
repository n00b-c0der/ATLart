<!DOCTYPE html>
<html>
<title>ATLart</title>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" media="screen" href="./assets/css/form.css">


    <style>
        body {
            font-family: "Raleway", Arial, sans-serif
        }

        .w3-row img {
            margin-bottom: -8px
        }
    </style>
</head>

<body>

    <div class="w3-content" style="max-width:1500px">

        <header class="w3-container w3-xlarge w3-padding-24">
            <a href="#" class="w3-left w3-button w3-white">MY ART</a>
            <a href="#about" class="w3-right w3-button w3-white">About</a>
            <a href="./html/googlemaps.html" class="w3-right w3-button w3-white">Map</a>

        </header>

        <div class="w3-row">
            <div class="w3-half">
                <img src="./assets/images/streetart.jpg" style="width:100%; height: 400px">
                <img src="./assets/images/streetart2.jpg" style="width:100%; height: 400px">
            </div>

            <div class="w3-half">
                <img src="./assets/images/streetart3.jpg" style="width:100%; height:400px">
                <img src="./assets/images/streetart4.jpg" style="width:100%; height:400px">

            </div>
        </div>

        <footer class="w3-light-grey w3-padding-64 w3-center" id="about">
            <h2>About</h2>
            <img src="./assets/images/about.jpg" class="w3-image w3-padding-32" width="300"
                height="300">
            <form style="margin:auto;width:60%" target="_blank">
                <p>Just me, myself and I, exploring the universe of unknownment. I have a heart of love and an interest
                    of lorem ipsum and mauris neque quam blog. I want to share my world with you. Praesent tincidunt sed
                    tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non
                    fringilla. Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae,
                    ultricies congue gravida diam non fringilla.</p>
                <!-- Button to open the modal -->
                <button onclick="document.getElementById('id01').style.display='block'">Art Submission</button>

                <!-- The Modal (contains the Sign Up form) -->
                <div id="id01" class="modal">
                    <span onclick="document.getElementById('id01').style.display='none'" class="close"
                        title="Close Modal"></span>
                    <div class="container">
                        <h1>Art Submission</h1>
                        <p>Please fill in this form to submit street art.</p>

                        <div class="form-group row">
                            <label for="name-input">Name/Artist:</label>
                            <input class="form-control" id="userName" type="text" required>
                        </div>
                        <div class="form-group row">
                            <label for="email-input">Image title:</label>
                            <input class="form-control" id="imageTitle" type="text" required>
                        </div>
                        <div class="form-group row">
                            <label for="age-input">Upload Date:</label>
                            <input class="form-control" id="uploadDate" type="date" required>
                        </div>
                        <div class="form-group row">
                            <label for="age-input">Address:</label>
                            <input class="form-control" id="Address" type="text" required>
                        </div>
                        <div class="form-group row">
                            <label for="age-input">Description:</label>
                            <input class="form-control" id="Description" type="text" required>
                        </div>

                        <div>
                            <img src="" class="displayImages">
                        </div>
                        <p>By submitting the art, you agree to our <a href="#" style="color:dodgerblue">Terms &
                                Privacy</a>.</p>

                        <div class="clearfix">
                            <button type="button" onclick="document.getElementById('id01').style.display='none'"
                                class="cancelbtn">Cancel</button>
                            <label function previewFile() {
                                var preview = document.querySelector(img);
                                var file    = document.querySelector(input[type= file]).files[0];
                                var reader  = new FileReader();
                              
                                reader.onloadend = function () {
                                  preview.src = reader.result;
                                }
                              
                                if (file) {
                                  reader.readAsDataURL(file);
                                } else {
                                  preview.src = "";
                                }
                              }>
                              <input type="file" onchange="previewFile()"><br>
                              <img src="" height="200" alt="Image preview...">
                            </label>
                            
                            <button type="button" class="signup">Sign Up</button>

                        </div>
                    </div>
                </div>
            </form>
        </footer>
        <!--firebase upload/download-->

    </div>
    <script src="https://www.gstatic.com/firebasejs/5.9.3/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


    <script>
        $(document).ready(function () {
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyCQUPXI0N7-b4bOpNlb6n8ML1p6YW5VJ48",
                authDomain: "ronwab-8dbcd.firebaseapp.com",
                databaseURL: "https://ronwab-8dbcd.firebaseio.com",
                projectId: "ronwab-8dbcd",
                storageBucket: "ronwab-8dbcd.appspot.com",
                messagingSenderId: "148535054528"
            };
            firebase.initializeApp(config);
            database = firebase.database()
            var selectedFile;
            // var imageTitle;
            // var userName;
            // var uploadDate = 0;
            // var Address = 0
            // var Description;
            var CLOUDNARY_URL = 'https://api.cloudinary.com/v1_1/ronwab/upload'
            var CLOUDNARY_UPLOAD_PRESET = 'ffghjylr'
            var fileUpload = document.getElementById('file-upload');
            var userFile
            var imageName
            var LocationCoods = 0

            fileUpload.addEventListener('change', function (event) {
                event.preventDefault()
                console.log()
                userFile = event.target.files[0]
                imageName = event.target.files[0].name
                
            })
            // function disableSubmit() {
            //     if (imageTitle === "" || userName === "" || uploadDate === "" || imageName === "" || Address === "" ||
            //         Description === ""){
            //         }else{
            //         }
            // }
            $(document).on("click", ".signup", function FunctionSubmit(event) {
                event.preventDefault()
                var imageTitle = $('#imageTitle').val().toLowerCase();
                var userName = $('#userName').val().toLowerCase();
                var uploadDate = $('#uploadDate').val().toLowerCase();
                var Address = $('#Address').val().toLowerCase();
                var Description = $('#Description').val().toLowerCase();
                console.log(userName);
              
                var formData = new FormData();
                formData.append('file', userFile);
                formData.append('upload_preset', CLOUDNARY_UPLOAD_PRESET)

                axios({
                    url: CLOUDNARY_URL,
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    data: formData

                }).then(function (res) {
                    // console.log(res);
                    // console.log(res.data.url)
                    // var testing2 = res.data.url
                    // console.log("inside the cloud");
                    // var imageOnPage = $(".displayImages")
                    // $(".displayImages").attr('src', testing2)
                })

                axios({
                url: "https://maps.googleapis.com/maps/api/geocode/json?address=" +
                    Address + "&key=AIzaSyDq2hOQHj-qstNYUsl7a8kHOtrkeJVhdro",
                method: "GET"
                }).then(function (data) {
                console.log(data);
                // console.log(data.results[0].geometry.location);

                LocationCoods = data.data.results[0].geometry.location
                console.log(LocationCoods);

                var personDetails = {
                    imageTitleField: imageTitle,
                    userNameField: userName,
                    DateField: uploadDate,
                    AddressField: Address,
                    DescriptionField: Description,
                    ImageField: imageName,
                    locationCoodsvals: LocationCoods
                }

                database.ref().push(personDetails)

            })
            })
        })

    </script>

</body>

</html>